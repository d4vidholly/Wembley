<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wembley Board Game - Match Simulator</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap" rel="stylesheet">
  <style>

  </style>
</head>
<body>


  <header div="">
  Wembley Match Simulator
  
  <span div="tooltip">

    <img class="" id="help-icon" src="icon-help.svg" alt="icon help" style="display: none;">

  </span>

  </header>

  <div id="matchSetupContainer">

  <div class="container">
    
    <div class="match-area">
      
      <div class="teams">
        
        <!-- Home Team Panel -->
        <div class="team-panel">
          <div>Home</div>
          <img id="teamBadgeHome" src="arsenal.svg" alt="Home Team Badge" width="100">

          <div id="starContainerHome" style="display: none;"></div>
          <div id="divisionTextHome"></div>

          <select class="team-select" id="teamSelectHome">
            <div class="option-list">
            <option value="Arsenal">Arsenal</option>
            <option value="Barnsley">Barnsley</option>
            <option value="Blackpool">Blackpool</option>
            <option value="Bournemouth">Bournemouth</option>
            <option value="Bristol City">Bristol City</option>
            <option value="Carlisle">Carlisle</option>
            <option value="Charlton Ath">Charlton Ath</option>
            <option value="Chelsea">Chelsea</option>
            <option value="Exeter">Exeter City</option>
            <option value="Fulham">Fulham</option>
            <option value="Hereford">Hereford</option>
            <option value="Hull City">Hull City</option>
            <option value="Liverpool">Liverpool</option>
            <option value="Leeds Utd">Leeds Utd</option>
            <option value="Man City">Man City</option>
            <option>Man Utd</option>
            <option>Newcastle</option>
            <option value="Nottm Forest">Nottm Forest</option>
            <option value="Port Vale">Port Vale</option>
            <option value="Portsmouth">Portsmouth</option>
            <option value="Reading">Reading</option>
            <option value="Rochdale">Rochdale</option>
            <option value="Shrewsbury">Shrewsbury</option>
            <option value="Southend">Southend</option>
            <option value="Tottenham">Tottenham</option>
            <option>Tow Law</option>
            <option value="Watford">Watford</option>
            <option value="West Brom">West Brom</option>
            <option value="West Ham">West Ham</option>
            <option value="Wimbledon">Wimbledon</option>
            <option>Wolves</option>
            <option>Wrexham</option>
          </div>
          </select>

          <div class="Key-Player-Toggle">

            <div class="key-player-checkbox" >

              <div class="international-stars tooltip">
                <p>Select International Stars:</p>
                <span class="tooltip-text">International Stars can be added to your team to improve your odds.
                  <br>
                  <br>
                  Goalkeeper: +1 Goal
                  <br>
                  Defender: +1 Goal
                  <br>
                  Midfielder: +1 Goal
                  <br>
                  Striker: +1 Goal
                </span>
              </div>

              <div class="home-team-stars">

              <input type="checkbox" id="position1" name="position1" value="Goalkeeper">
              <label for="position1"> Goalkeeper</label><br>
              <input type="checkbox" id="position2" name="position2" value="Defender">
              <label for="position2"> Defender</label><br>
              <input type="checkbox" id="position3" name="position3" value="Midfielder">
              <label for="position3"> Midfielder</label><br>
              <input type="checkbox" id="position4" name="position4" value="Striker">
              <label for="position4"> Striker</label><br>
            
            </div>
            
            </div>
          </div>
          

        </div>
      
        <!-- Round Select -->
        
        <div class="match-details">

          <img src="fa-cup-logo.svg" alt="FA Cup Logo" height="100" class="fa-cup-logo">

        <div class="round-select">

          <select class="round-dropdown" id="roundSelect">
            <option value="Round of 32">Round of 32</option>
            <option value="Round of 16">Round of 16</option>
            <option value="Quarter Final">Quarter Final</option>
            <option value="Semi Final">Semi Final</option>
            <option value="Final">Final</option>
          </select>
        </div>

        <div class="match-details-stadium">
          <img class="icon" id="stadium-icon" src="icon-stadium.svg" alt="icon stadium" width="20">
        <div id="stadiumTextHome">
          <p></p>
        </div>
        <div id="kickOffTime">
        <p></p>
        </div>
    
      </div>

      <div class="match-details-stadium">

      <div class="match-details-money">

        <div class="money-item">

          <img class="icon tooltip" id="ticket-icon" src="icon-ticket.svg" alt="icon ticket" width="20">
  
          <div id="prizeMoneyContainer">
            <p id="prizeMoney"></p>
          </div>
  
          </div>

        <div class="money-item">

          <img class="icon tooltip" id="prize-icon" src="icon-prize.svg" alt="icon prize" width="20">  

        <div id="ticketRevenueContainer">
          <p id="ticketRevenue"></p>
        </div>

      </div>
      </div>
      </div> 

      <div class="match-details-stadium">

        <img class="icon" id="rules-icon" src="icon-rules.svg" alt="icon rules" width="20">
  
          <div id="ifDrawContainer">
          <p id="ifDraw"></p>
          </div>
  
        </div> 

      </div>
      
        <!-- Away Team Panel -->
        <div class="team-panel">
          <div>Away</div>
          <img id="teamBadgeAway" src="arsenal.svg" alt="Away Team Badge" width="100">

          <div id="starContainerAway" style="display: none;"> </div>
          <div id="divisionTextAway"></div>

          <select class=team-select id="teamSelectAway">
            <option value="Arsenal">Arsenal</option>
            <option value="Barnsley">Barnsley</option>
            <option value="Blackpool">Blackpool</option>
            <option value="Bournemouth">Bournemouth</option>
            <option value="Bristol City">Bristol City</option>
            <option value="Carlisle">Carlisle</option>
            <option value="Charlton Ath">Charlton Ath</option>
            <option value="Chelsea">Chelsea</option>
            <option value="Exeter">Exeter City</option>
            <option value="Fulham">Fulham</option>
            <option value="Hereford">Hereford</option>
            <option value="Hull City">Hull City</option>
            <option value="Liverpool">Liverpool</option>
            <option value="Leeds Utd">Leeds Utd</option>
            <option value="Man City">Man City</option>
            <option>Man Utd</option>
            <option>Newcastle</option>
            <option value="Nottm Forest">Nottm Forest</option>
            <option value="Port Vale">Port Vale</option>
            <option value="Portsmouth">Portsmouth</option>
            <option value="Reading">Reading</option>
            <option value="Rochdale">Rochdale</option>
            <option value="Shrewsbury">Shrewsbury</option>
            <option value="Southend">Southend</option>
            <option value="Tottenham">Tottenham</option>
            <option>Tow Law</option>
            <option value="Watford">Watford</option>
            <option value="West Brom">West Brom</option>
            <option value="West Ham">West Ham</option>
            <option value="Wimbledon">Wimbledon</option>
            <option>Wolves</option>
            <option>Wrexham</option>
            
          </select>

          <div class="Key-Player-Toggle">

            <div class="key-player-checkbox-away">

              <div class="international-stars tooltip">
                <p>Select International Stars:</p>
                <span class="tooltip-text">International Stars can be added to your team to improve your odds.
                  <br>
                  <br>
                  Goalkeeper: +1 Goal
                  <br>
                  Defender: +1 Goal
                  <br>
                  Midfielder: +1 Goal
                  <br>
                  Striker: +1 Goal
                </span>
                </div>

              <div class="away-team-stars">

              <input type="checkbox" id="position1-away" name="position1-away" value="Goalkeeper">
              <label for="position1-away"> Goalkeeper</label><br>
              <input type="checkbox" id="position2-away" name="position2-away" value="Defender">
              <label for="position2-away"> Defender</label><br>
              <input type="checkbox" id="position3-away" name="position3-away" value="Midfielder">
              <label for="position3-away"> Midfielder</label><br>
              <input type="checkbox" id="position4-away" name="position4-away" value="Striker">
              <label for="position4-away"> Striker</label><br>
            
            </div>

            </div>
          </div>

        </div>
      </div>

      </div>

      <div class="simulate-container">
        <button class=simulate-btn id="simulateButton" disabled>PLAY MATCH</button>
      </div>

    
<footer>
  
  <div class="banner">
    <div class="copyright">Personal Project, Designed and Developed by David Holly</div>
  </div>
</footer>

</div>

<div id="matchReportModal" class="modal hidden">
  <div class="modal-content">
    <div class="content">
    <h2>Match Report</h2>
    <p id="reportRound"></p>

      <div class="match-result">
      <div class="home-result result">
      <img id="reportHomeBadge" src="arsenal.svg" alt="Home Team Badge" width="100">
      <div>
        <p id="reportHomeName"></p>
        </div>
        </div>

      <p id="reportScore"></p>

      <div class="away-result result">
      <img id="reportAwayBadge" src="arsenal.svg" alt="Away Team Badge" width="100">
      <div>
        <p id="reportAwayName"></p>
      </div>
    </div>

  </div>

  <p>Match Earnings</p>

  <div class="match-result">

    <div id="ticketHome">
      <p></p>
    </div>
    
    <div>
      <img id="ticket-icon" src="icon-ticket.svg" alt="ticket" width="20">
    </div>

    <div id="ticketAway">
      <p></p>
    </div>
  </div>

  <div class="match-result">

    <div id="prizeHome">
      <p></p>
    </div>
    
    <div>
      <img id="prize-icon" src="icon-prize.svg" alt="prize" width="20">
    </div>

    <div id="prizeAway">
      <p></p>
    </div>
  </div>

  <div class="match-result">

    <div id="tvHome">
      <p></p>
    </div>
    
    <div>
      <img id="tv-icon" src="icon-tv.svg" alt="tv" width="20">
    </div>

    <div id="tvAway">
      <p></p>
    </div>
  </div>

  <div class="match-result">

    <div id="totalHome">
      <b><p></p></b>
    </div>
    
    <div>
      <b>Total</b>
    </div>

    <div id="totalAway">
      <b><p></p></b>
    </div>
  </div>



    <h3>
      
      <div>

      <span id="reportResult"></span>
    
    </h3>
    
    <button class="report-button" id="closeReport" onclick="closeModal()">NEW MATCH</button>

    <button class="report-button" id="replayButton" class="hidden">REPLAY MATCH</button>

  </div>

  </div>



</div>

      
      <script>

        // Home team logic
        const teamSelectHome = document.getElementById('teamSelectHome');
        const teamBadgeHome = document.getElementById('teamBadgeHome');
        const divisionTextHome = document.getElementById('divisionTextHome');
        const starContainerHome = document.getElementById('starContainerHome');
        const stadiumTextHome = document.getElementById('stadiumTextHome');
        const prizeMoney = document.getElementById('prizeMoney');
      
        const teams = {
          "Arsenal": { badge: "arsenal.svg", division: "Premier Division", stars: "★★★", stadium: "Emirates Stadium", gate: "$12000", location: "North London" },
          "Man City": { badge: "man-city.svg", division: "Premier Division", stars: "★★★", stadium: "Etihad Stadium", gate: "$12000", location: "North-West" },
          "Man Utd": { badge: "man-utd.svg", division: "Premier Division", stars: "★★★", stadium: "Old Trafford", gate: "$15000", location: "North-West" },
          "Liverpool": { badge: "liverpool.svg", division: "Premier Division", stars: "★★★", stadium: "Anfield", gate: "$15000", location: "North-West" },
          "Chelsea": { badge: "chelsea.svg", division: "Championship", stars: "★★", stadium: "Stamford Bridge", gate: "$6000", location: "London" },
          "Hull City": { badge: "hull-city.svg", division: "Third Division", stars: "★", stadium: "KC Stadium", gate: "$2400", location: "Yorkshire" },
          "Bristol City": { badge: "bristol-city.svg", division: "Championship", stars: "★★", stadium: "Ashton Gate", gate: "$3000", location: "Midlands" },
          "Blackpool": { badge: "blackpool.svg", division: "Third Division", stars: "★", stadium: "Bloomfield Road", gate: "$2400", location: "North West" },
          "Barnsley": { badge: "barnsley.svg", division: "Third Division", stars: "★", stadium: "Oakwell", gate: "$1500", location: "Yorkshire" },
          "Carlisle": { badge: "carlisle.svg", division: "Third Division", stars: "★", stadium: "Brunton Park", gate: "$900", location: "North East" },
          "Charlton Ath": { badge: "charlton-athletic.svg", division: "Third Division", stars: "★", stadium: "The Valley", gate: "$1500", location: "London" },
          "Bournemouth": { badge: "bournemouth.svg", division: "Third Division", stars: "★", stadium: "Vitality Stadium", gate: "$900", location: "South Coast" },
          "Exeter": { badge: "exeter.svg", division: "Third Division", stars: "★", stadium: "St James Park", gate: "$1500", location: "" },
          "Reading": { badge: "reading.svg", division: "Third Division", stars: "★", stadium: "Madjeski Stadium", gate: "$2400", location: "London" },
          "Hereford": { badge: "hereford.svg", division: "Third Division", stars: "★", stadium: "Edgar Street", gate: "$1500", location: "Hereford" },
          "Fulham": { badge: "fulham.svg", division: "Third Division", stars: "★", stadium: "Craven Cottage", gate: "$2400", location: "London" },
          "Portsmouth": { badge: "portsmouth.svg", division: "Third Division", stars: "★", stadium: "Fratton Park", gate: "$2400", location: "South Coast" },
          "Port Vale": { badge: "port-vale.svg", division: "Third Division", stars: "★", stadium: "Vale Park", gate: "$1500", location: "Midlands" },
          "Southend": { badge: "southend.svg", division: "Third Division", stars: "★", stadium: "Roots Hall", gate: "$1500", location: "London" },
          "Shrewsbury": { badge: "shrewsbury.svg", division: "Third Division", stars: "★", stadium: "King Power Stadium", gate: "$3000", location: "Midlands" },
          "Wrexham": { badge: "wrexham.svg", division: "League One", stars: "★★", stadium: "Racecourse Ground", gate: "$3000", location: "Wales" },
          "Tottenham": { badge: "tottenham.svg", division: "Premier Division", stars: "★★★", stadium: "Tottenham Hotspur Stadium", gate: "$12000", location: "North London" },
          "Leeds Utd": { badge: "leeds.svg", division: "Premier Division", stars: "★★★", stadium: "Elland Road", gate: "$9000", location: "Yorkshire" },
          "Wolves": { badge: "wolves.svg", division: "Premier Division", stars: "★★★", stadium: "Molineux", gate: "$9000", location: "West Midlands" },
          "West Brom": { badge: "west-brom.svg", division: "Premier Division", stars: "★★★", stadium: "Hawthorns", gate: "$9000", location: "West Midlands" },
          "West Ham": { badge: "west-ham.svg", division: "Championship", stars: "★★", stadium: "London Stadium", gate: "$4500", location: "London" },
          "Watford": { badge: "watford.svg", division: "Championship", stars: "★★", stadium: "Vicarage Road", gate: "$4500", location: "London" },
          "Nottm Forest": { badge: "nottm-forest.svg", division: "Championship", stars: "★★", stadium: "City Ground", gate: "$4500", location: "Midlands" },
          "Rochdale": { badge: "rochdale.svg", division: "Third Division", stars: "★", stadium: "Spotlands", gate: "$900", location: "" },
          "Newcastle": { badge: "newcastle.svg", division: "Championship", stars: "★★", stadium: "St James Park", gate: "$6000", location: "North East" },
          "Wimbledon": { badge: "wimbledon.svg", division: "Third Division", stars: "★", stadium: "Plough Lane", gate: "$2400", location: "London" },
          "Tow Law": { badge: "tow-law.svg", division: "Third Division", stars: "★", stadium: "Ironworks Road", gate: "$900", location: "North East" }
        };
      
        teamSelectHome.addEventListener('change', updateHomeTeamUI);
      
        function updateHomeTeamUI() {
          const selectedTeam = teamSelectHome.value;
      
          if (teams[selectedTeam]) {
            teamBadgeHome.src = teams[selectedTeam].badge;
            divisionTextHome.textContent = teams[selectedTeam].division;
            stadiumTextHome.textContent = teams[selectedTeam].stadium;
            starContainerHome.innerHTML = teams[selectedTeam].stars;
            starContainerHome.style.display = "block";
            prizeMoney.innerText = "" + teams[selectedTeam].gate; 
          } else {
            teamBadgeHome.src = "#"; 
            divisionTextHome.textContent = ""; 
            starContainerHome.style.display = "none"; 
            prizeMoney.innerText = "";
          }
          updateStadium();
        }
      
        function updateStadium() {
          const selectedRound = roundSelect.value;
          const selectedTeam = teamSelectHome.value;
      
          if (selectedRound === "Semi Final" || selectedRound === "Final") {
            stadiumTextHome.textContent = "Wembley";
            prizeMoney.innerText = roundData[selectedRound].revenue;
          } else if (teams[selectedTeam]) {
            stadiumTextHome.textContent = teams[selectedTeam].stadium;
            prizeMoney.innerText = teams[selectedTeam].gate;
          } else {
            stadiumTextHome.textContent = "";
            prizeMoney.innerText = "";
          }
        }
      
        // Away team logic
        const teamSelectAway = document.getElementById('teamSelectAway');
        const teamBadgeAway = document.getElementById('teamBadgeAway');
        const divisionTextAway = document.getElementById('divisionTextAway');
        const starContainerAway = document.getElementById('starContainerAway');
      
        teamSelectAway.addEventListener('change', updateAwayTeamUI);
      
        function updateAwayTeamUI() {
          const selectedTeam = teamSelectAway.value;
      
          if (teams[selectedTeam]) {
            teamBadgeAway.src = teams[selectedTeam].badge;
            divisionTextAway.textContent = teams[selectedTeam].division;
            starContainerAway.innerHTML = teams[selectedTeam].stars;
            starContainerAway.style.display = "block";
          } else {
            teamBadgeAway.src = "#"; 
            divisionTextAway.textContent = ""; 
            starContainerAway.style.display = "none";
          }
          enableSimulateButton();
        }

 // Round select logic
        const roundSelect = document.getElementById('roundSelect');
const ticketRevenue = document.getElementById('ticketRevenue');
const ifDraw = document.getElementById('ifDraw');
const kickOffTime = document.getElementById('kickOffTime');

const roundData = {
  "Round of 32": {revenue: "-", ifDraw: "Replay if Draw", kickoff: "15:00 - Day", stadium: "",},
  "Round of 16": {revenue: "-", ifDraw: "Replay if Draw", kickoff: "19:45 - Night", stadium: ""},
  "Quarter Final": {revenue: "-", ifDraw: "Replay if Draw", kickoff: "15:00 - Day", stadium: ""},
  "Semi Final": {revenue: "$30000", ifDraw: "Penalty Shoot Out if Draw", kickoff: "15:00 - Day", stadium: "Wembley"},
  "Final": {revenue: "$75000", ifDraw: "Penalty Shoot Out if Draw", kickoff: "15:00 - Day", stadium: "Wembley"}
};

roundSelect.addEventListener('change', updateRoundUI);

function updateRoundUI() {
  const selectedRound = roundSelect.value;
  
  if (roundData[selectedRound]) {
    ticketRevenue.innerText = roundData[selectedRound].revenue;
    ifDraw.innerText = roundData[selectedRound].ifDraw;
    kickOffTime.innerText = roundData[selectedRound].kickoff;
  } else {
    ticketRevenue.innerText = "-";
    ifDraw.innerText = "-";
    kickOffTime.innerText = "-";
  }
          updateStadium();
          enableSimulateButton();
        }

let isReplay = false;

function parseStars(stars) {
}

//International Star probabilities

function calculateBonus(team) {
  const container = document.querySelector(`.${team}-team-stars`);
  const checkboxes = container.querySelectorAll('input[type="checkbox"]:checked');

  let bonus = 0;

  checkboxes.forEach(cb => {
    if (cb.value === 'Goalkeeper' || cb.value === 'Defender' || cb.value === 'Midfielder' || cb.value === 'Striker') {
      const chance = Math.random();
      if (chance <= 1) {
        bonus += 1;
      }
    }
  });

  return bonus;
}

      
        // ---- INITIALIZE on page load ----
        
        window.addEventListener('load', function () {
  updateHomeTeamUI();
  updateAwayTeamUI();
  updateRoundUI();
  enableSimulateButton();

  const matchSetup = document.getElementById('matchSetupContainer');
  const matchReport = document.getElementById('matchReportModal');
  const simulateButton = document.getElementById('simulateButton');
  const closeBtn = document.getElementById('closeReport');

  simulateButton.addEventListener('click', () => {
    const homeName = teamSelectHome.value;
    const awayName = teamSelectAway.value;
    const round = roundSelect.value;

    if (homeName && awayName && homeName !== "Select Team" && awayName !== "Select Team") {
      simulateMatch(homeName, awayName, round, isReplay);
    }
  });

  closeBtn.addEventListener('click', () => {
    matchReport.classList.add('hidden');
    matchSetup.classList.remove('blurred');
  });

  function simulateMatch(homeName, awayName, round, isReplay = false) {
    const homeBadge = teams[homeName].badge;
    const awayBadge = teams[awayName].badge;

    const homeStars = parseStars(teams[homeName].stars);
    const awayStars = parseStars(teams[awayName].stars);

    const homeGoals = rollGoals(homeStars, 'home');
    const awayGoals = rollGoals(awayStars, 'away');

    // Add bonus goals for international stars
    const homeBonus = calculateBonus('home');
    const awayBonus = calculateBonus('away');

    const finalHomeGoals = homeGoals + homeBonus;
    const finalAwayGoals = awayGoals + awayBonus;

    // Update match report UI
    document.getElementById('reportRound').innerText = `FA Cup ${round}${isReplay ? ' Replay' : ''} Result`;
    document.getElementById('reportHomeBadge').src = homeBadge;
    document.getElementById('reportAwayBadge').src = awayBadge;
    document.getElementById('reportHomeName').innerText = homeName.toUpperCase();
    document.getElementById('reportAwayName').innerText = awayName.toUpperCase();
    document.getElementById('reportScore').innerText = `${finalHomeGoals} - ${finalAwayGoals}`;

    // Determine match result
    let winnerKey;
    let resultText;
    const knockoutRounds = ['Semi Final', 'Final'];

    if (finalHomeGoals > finalAwayGoals) {
      winnerKey = "home";
      resultText = `${homeName} progress to the next round`;
    } else if (finalAwayGoals > finalHomeGoals) {
      winnerKey = "away";
      resultText = `${awayName} progress to the next round`;
    } else {
      if (knockoutRounds.includes(round) || isReplay) {
        const winner = Math.random() < 0.5 ? homeName : awayName;
        winnerKey = (winner === homeName) ? "home" : "away";
        resultText = `End of 90 minutes – ${winner} win on penalties${isReplay ? '' : ''}`;
      } else {
        winnerKey = "draw";
        resultText = `Match Drawn – Replay Scheduled`;
        showReplayButton(homeName, awayName, round);
      }
    }

    // Calculate and display gate revenue money
    const prize = calculatePrizeMoney(homeName, winnerKey, round);
    document.querySelector("#ticketHome p").textContent = `$${prize.home.toLocaleString()}`;
    document.querySelector("#ticketAway p").textContent = `$${prize.away.toLocaleString()}`;

    // Calculate and display round bonus money
    let homeBonusAmount = 0;
let awayBonusAmount = 0;

// No round bonus if Quarter Final ends in a draw (before replay)
if (!(round === 'Quarter Final' && winnerKey === 'draw' && !isReplay)) {
  homeBonusAmount = calculateRoundBonus(round, teams[homeName].stars);
  awayBonusAmount = calculateRoundBonus(round, teams[awayName].stars);
}

document.querySelector("#prizeHome p").textContent = `$${homeBonusAmount.toLocaleString()}`;
document.querySelector("#prizeAway p").textContent = `$${awayBonusAmount.toLocaleString()}`;

    // Calculate and display TV bonus money
    const tvBonus = calculateTVBonus(homeStars, awayStars, round, isReplay);
document.querySelector("#tvHome p").textContent = `$${tvBonus.home.toLocaleString()}`;
document.querySelector("#tvAway p").textContent = `$${tvBonus.away.toLocaleString()}`;

    // Update total earnings
    updateTotaliser();

    // Final UI updates
    document.getElementById('reportResult').innerText = resultText;
    document.getElementById('matchReportModal').classList.remove('hidden');
    document.getElementById('matchSetupContainer').classList.add('blurred');
  }

  function showReplayButton(away, home, round) {
    const replayButton = document.getElementById("replayButton");
    replayButton.classList.remove("hidden");

    // Remove old listeners
    const newButton = replayButton.cloneNode(true);
    replayButton.parentNode.replaceChild(newButton, replayButton);

    newButton.addEventListener("click", () => {
      simulateMatch(home, away, round, true);
      newButton.classList.add("hidden");
    });
  }

  function updateTotaliser() {
    const getAmount = (selector) => {
      const text = document.querySelector(selector).textContent.replace(/[^\d]/g, '');
      return Number(text) || 0;
    };

    const homeTotal = getAmount('#ticketHome p') + getAmount('#prizeHome p') + getAmount('#tvHome p');
    const awayTotal = getAmount('#ticketAway p') + getAmount('#prizeAway p') + getAmount('#tvAway p');

    document.querySelector('#totalHome p').textContent = `$${homeTotal.toLocaleString()}`;
    document.querySelector('#totalAway p').textContent = `$${awayTotal.toLocaleString()}`;
  }
});

function parseStars(starString) {
  return starString.replace(/[^★]/g, '').length; // Only count "★" symbols
}



// Add dice probability here

const goalChancesByStars = {

  home: {
  1: [
    { goals: 0, weight: 33.3 },
    { goals: 1, weight: 16.7 },
    { goals: 2, weight: 16.7 },
    { goals: 3, weight: 0 },
    { goals: 4, weight: 16.7 },
    { goals: 5, weight: 16.7 }
  ],
  2: [
    { goals: 0, weight: 16.7 },
    { goals: 1, weight: 16.7 },
    { goals: 2, weight: 33.3 },
    { goals: 3, weight: 16.7 },
    { goals: 4, weight: 16.7  },
    { goals: 5, weight: 0 },
  ],
  3: [
    { goals: 0, weight: 16.7 },
    { goals: 1, weight: 16.7 },
    { goals: 2, weight: 16.7 },
    { goals: 3, weight: 16.7 },
    { goals: 4, weight: 33.3 },
    { goals: 5, weight: 0 },
  ]
  },

  away: {
  1: [
  { goals: 0, weight: 33.3 },
    { goals: 1, weight: 16.7 },
    { goals: 2, weight: 16.7 },
    { goals: 3, weight: 0 },
    { goals: 4, weight: 16.7 },
    { goals: 5, weight: 16.7 }

  ],
  2: [
  { goals: 0, weight: 16.7 },
    { goals: 1, weight: 33.3 },
    { goals: 2, weight: 16.7 },
    { goals: 3, weight: 0 },
    { goals: 4, weight: 16.7 },
    { goals: 5, weight: 0 }

  ],
  3: [
  { goals: 0, weight: 16.7 },
    { goals: 1, weight: 16.7 },
    { goals: 2, weight: 16.7 },
    { goals: 3, weight: 33.3 },
    { goals: 4, weight: 16.7 },
    { goals: 5, weight: 0 }
  ]
}

};

function rollGoals(stars, side = 'home') {
  const goalChances = goalChancesByStars[side]?.[stars] || [];

  // Calculate total weight
  const totalWeight = goalChances.reduce((sum, entry) => sum + entry.weight, 0);

  // Generate random number
  const random = Math.random() * totalWeight;

  // Select goal based on weight
  let cumulative = 0;
  for (const entry of goalChances) {
    cumulative += entry.weight;
    if (random <= cumulative) {
      return entry.goals;
    }
  }

  // Fallback
  return 0;
}


// Prize Money

function parseMoney(moneyString) {
  return parseInt(moneyString.replace(/\$/g, "").replace(/,/g, ""));
}

function calculatePrizeMoney(homeTeam, winner, round) {
  let totalRevenue;

  if (round === "Semi Final" || round === "Final") {
    totalRevenue = parseMoney(roundData[round].revenue);
  } else {
    totalRevenue = parseMoney(teams[homeTeam].gate);
  }

  let homeShare = 0;
  let awayShare = 0;

  if (winner === "draw") {
    homeShare = awayShare = totalRevenue / 2;
  } else if (winner === "home") {
    homeShare = (2 / 3) * totalRevenue;
    awayShare = (1 / 3) * totalRevenue;
  } else if (winner === "away") {
    homeShare = (1 / 3) * totalRevenue;
    awayShare = (2 / 3) * totalRevenue;
  }

  return {
    home: Math.round(homeShare),
    away: Math.round(awayShare)
  };
}

function calculateRoundBonus(round, stars) {
  const starNum = parseStars(stars); // convert "★★★" to 3

  const bonusMatrix = {
    "Quarter Final": { 3: 2000, 2: 4000, 1: 6000 },
    "Semi Final":    { 3: 4000, 2: 8000, 1: 12000 }
  };

  if (bonusMatrix[round]) {
    return bonusMatrix[round][starNum] || 0;
  }
  return 0;
}

const homePayoutElement = document.querySelector("#ticketHome p");
const awayPayoutElement = document.querySelector("#ticketAway p");

const homeTeam = teamSelectHome.value;
const round = roundSelect.value;

const prize = calculatePrizeMoney(homeName, awayName, winnerKey, selectedRound);

homePayoutElement.textContent = `$${prize.home.toLocaleString()}`;
awayPayoutElement.textContent = `$${prize.away.toLocaleString()}`;

// Calculate TV Bonus Money

function calculateTVBonus(homeStars, awayStars, round, isReplay = false) {
  let homeBonus = 0;
  let awayBonus = 0;

  const isKnockout = (round === 'Semi Final' || round === 'Final');

  // Rule 1: 1-star at home vs 3-star away (except for Semi/Final)
  if (!isKnockout && homeStars === 1 && awayStars === 3) {
    homeBonus += 1000;
    awayBonus += 0;
  }

  // Rule 2: All Semi Final and Final matches get TV bonus
  if (isKnockout) {
    homeBonus += 1000;
    awayBonus += 1000;
  }

  return {
    home: homeBonus,
    away: awayBonus
  };
}





// Enable simulate button only when inputs are valid
function enableSimulateButton() {
  const homeSelected = teamSelectHome.value !== "Select Team";
  const awaySelected = teamSelectAway.value !== "Select Team";
  const roundSelected = roundSelect.value !== "Select Round";

  const simulateButton = document.getElementById('simulateButton');
  simulateButton.disabled = !(homeSelected && awaySelected && roundSelected);
}

updateTotaliser();


</script>

</body>
</html>